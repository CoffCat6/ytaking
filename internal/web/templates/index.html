{{define "content"}}
<section id="about" class="section about">
  <div class="about-left">
    <div class="about-avatar">
      {{if .Avatar}}
      <img src="{{.Avatar}}" alt="{{.Title}}"
        data-avatar-pos-x="{{printf "%.0f" .AvatarPosX}}"
        data-avatar-pos-y="{{printf "%.0f" .AvatarPosY}}"
        data-avatar-scale="{{printf "%.2f" .AvatarScale}}"
        style="object-position: 50% 50%; transform: scale(1);">
      {{else}}
      <div class="avatar-placeholder">上传头像</div>
      {{end}}
    </div>
    <div class="about-copy">
      <h2>关于我</h2>
      <p class="about-position">{{if .Positioning}}{{.Positioning}}{{else}}{{.Intro}}{{end}}</p>
      <div class="about-tags">
        {{range .Skills}}
        <span>{{.}}</span>
        {{end}}
      </div>
      <div class="about-links">
        {{if .Email}}
        <a class="social-pill" href="mailto:{{.Email}}">
          <span class="social-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="img" focusable="false">
              <path d="M4 6.5h16a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2zm0 2.2v6.8h16V8.7l-8 5.1-8-5.1zm8 3.4 8-5.1H4l8 5.1z"></path>
            </svg>
          </span>
          邮箱
        </a>
        {{end}}
        {{range .SocialLinks}}
        <a class="social-pill" href="{{.URL}}" target="_blank" rel="noopener">
          <span class="social-icon" aria-hidden="true">
            {{if eq .Name "GitHub"}}
            <svg viewBox="0 0 24 24" role="img" focusable="false">
              <path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.55 2.87 8.4 6.84 9.76.5.09.68-.22.68-.49 0-.24-.01-.87-.01-1.71-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.11-1.5-1.11-1.5-.91-.64.07-.63.07-.63 1 .07 1.53 1.05 1.53 1.05.9 1.56 2.36 1.11 2.94.85.09-.67.35-1.11.64-1.37-2.22-.26-4.56-1.14-4.56-5.06 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.32.1-2.75 0 0 .84-.27 2.75 1.05A9.3 9.3 0 0 1 12 6.8c.85 0 1.7.12 2.5.36 1.9-1.32 2.74-1.05 2.74-1.05.55 1.43.2 2.49.1 2.75.64.72 1.03 1.63 1.03 2.75 0 3.93-2.34 4.79-4.57 5.05.36.32.68.95.68 1.92 0 1.38-.01 2.5-.01 2.84 0 .27.18.59.69.49A10.03 10.03 0 0 0 22 12.26C22 6.58 17.52 2 12 2z"></path>
            </svg>
            {{else}}
            <svg viewBox="0 0 24 24" role="img" focusable="false">
              <path d="M14 3h7v7h-2V6.41l-9.3 9.3-1.4-1.42 9.3-9.3H14V3zM5 5h6v2H7v10h10v-4h2v6H5V5z"></path>
            </svg>
            {{end}}
          </span>
          {{.Name}}
        </a>
        {{end}}
      </div>
    </div>
  </div>
  <div class="about-right">
    <div class="about-card">
      <h3>近期计划</h3>
      <ul>
        {{range .CurrentFocus}}
        <li>{{.}}</li>
        {{end}}
      </ul>
    </div>
  </div>
</section>

<section class="hero">
  <div class="hero-copy">
    <p class="eyebrow">{{.Tagline}}</p>
    <!-- <h1>写给热爱长期主义的人。</h1> -->
    <p class="lead">{{.Intro}}</p>
    <div class="hero-meta">
      <span class="meta-pill">{{.Location}}</span>
      <!-- <a class="meta-link" href="mailto:{{.Email}}">{{.Email}}</a> -->
    </div>
    <!-- <div class="hero-actions">
      <a class="primary-btn" href="#posts">阅读最新</a>
    </div> -->
  </div>
  <div class="hero-card">
    <div class="card-label">精选</div>
    {{if .FeaturedPosts}}
    <div class="featured-carousel" data-rotate="true">
      {{range $i, $post := .FeaturedPosts}}
      <div class="featured-slide {{if eq $i 0}}is-active{{end}}">
        {{if $post.CoverImage}}
        <div class="featured-thumb">
          <img src="{{$post.CoverImage}}" alt="{{$post.Title}}">
        </div>
        {{end}}
        <div class="featured-body">
          <h3>{{$post.Title}}</h3>
          <p>{{$post.Summary}}</p>
          <div class="card-meta">
            <span>{{formatDate $post.CreatedAt}}</span>
            {{if $post.Category}}<span class="badge">{{$post.Category}}</span>{{end}}
          </div>
          {{if $post.Tags}}
          <div class="tag-row">
            {{range $post.Tags}}<span class="tag">{{.}}</span>{{end}}
          </div>
          {{end}}
          <a class="text-link" href="{{$.SiteURL}}/posts/{{$post.Slug}}">阅读精选 -></a>
        </div>
      </div>
      {{end}}
    </div>
    {{else}}
    <h3>还没有精选文章</h3>
    <p>从后台新建一篇文章开始吧。</p>
    <a class="text-link" href="{{$.AdminURL}}/admin/posts/new">去创建 -></a>
    {{end}}
  </div>
</section>

<section id="posts" class="section">
  <div class="section-head">
    <h2>最新文章</h2>
    <p>每周更新一到两篇，关注产品、工程与写作。</p>
  </div>
  <div class="filter-bar">
    <div class="filter-group">
      <label for="filter-category">分类</label>
      <select id="filter-category">
        <option value="">全部</option>
        {{range .CategoryFilters}}
        <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
    <div class="filter-group">
      <label for="filter-tag">标签</label>
      <select id="filter-tag">
        <option value="">全部</option>
        {{range .TagFilters}}
        <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
  </div>
  <div class="post-grid fixed-grid">
    {{range .Posts}}
    <article class="post-card" data-category="{{.Category}}"
      data-tags="{{range $i, $t := .Tags}}{{if $i}},{{end}}{{lower $t}}{{end}}">
      <div class="post-thumb">
        {{if .CoverImage}}
        <img src="{{.CoverImage}}" alt="{{.Title}}">
        {{else}}
        <span>图片占位</span>
        {{end}}
      </div>
      <div class="post-meta">
        <span>{{formatDate .CreatedAt}}</span>
        {{if .Category}}<span class="badge" data-category="{{.Category}}">{{.Category}}</span>{{end}}
        {{if .Featured}}<span class="badge cat-featured">精选</span>{{end}}
      </div>
      {{if .Tags}}
      <div class="tag-row">
        {{range .Tags}}<span class="tag">{{.}}</span>{{end}}
      </div>
      {{end}}
      <h3>{{.Title}}</h3>
      <p>{{.Summary}}</p>
      <a class="text-link stretched-link" href="{{$.SiteURL}}/posts/{{.Slug}}">继续阅读 -></a>
    </article>
    {{end}}
  </div>
  <div class="pagination">
    {{if .HasPrev}}
    <a class="pagination-link" href="{{.PrevURL}}">← 上一页</a>
    {{else}}
    <span class="pagination-disabled">← 上一页</span>
    {{end}}
    <span class="pagination-info">第 {{.CurrentPage}} / {{.TotalPages}} 页</span>
    {{if .HasNext}}
    <a class="pagination-link" href="{{.NextURL}}">下一页 →</a>
    {{else}}
    <span class="pagination-disabled">下一页 →</span>
    {{end}}
  </div>
</section>




<script>
  (function () {
    var avatar = document.querySelector(".about-avatar img");
    if (!avatar) return;
    var posX = avatar.getAttribute("data-avatar-pos-x");
    var posY = avatar.getAttribute("data-avatar-pos-y");
    var scale = avatar.getAttribute("data-avatar-scale");
    if (posX !== null && posY !== null) {
      avatar.style.objectPosition = posX + "% " + posY + "%";
    }
    if (scale !== null) {
      avatar.style.transform = "scale(" + scale + ")";
    }
  })();
  (function () {
    var root = document.querySelector(".featured-carousel");
    if (!root) return;
    var slides = root.querySelectorAll(".featured-slide");
    if (slides.length <= 1) return;
    var index = 0;
    setInterval(function () {
      slides[index].classList.remove("is-active");
      index = (index + 1) % slides.length;
      slides[index].classList.add("is-active");
    }, 5000);
  })();
  (function () {
    var categorySelect = document.getElementById("filter-category");
    var tagSelect = document.getElementById("filter-tag");
    var cards = document.querySelectorAll(".post-card");
    if (!categorySelect || !tagSelect || cards.length === 0) return;
    function applyFilter() {
      var category = categorySelect.value;
      var tag = tagSelect.value.toLowerCase();
      cards.forEach(function (card) {
        var cardCategory = card.getAttribute("data-category") || "";
        var cardTags = (card.getAttribute("data-tags") || "").split(",");
        var matchCategory = category === "" || cardCategory === category;
        var matchTag = tag === "" || cardTags.indexOf(tag) >= 0;
        card.style.display = matchCategory && matchTag ? "flex" : "none";
      });
    }
    categorySelect.addEventListener("change", applyFilter);
    tagSelect.addEventListener("change", applyFilter);
  })();
</script>
{{end}}
