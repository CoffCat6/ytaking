{{define "content"}}
<section class="hero">
  <div class="hero-copy">
    <p class="eyebrow">{{.Tagline}}</p>
    <h1>写给热爱长期主义的人。</h1>
    <p class="lead">{{.Intro}}</p>
    <div class="hero-meta">
      <span class="meta-pill">{{.Location}}</span>
      <a class="meta-link" href="mailto:{{.Email}}">{{.Email}}</a>
    </div>
    <div class="hero-actions">
      <a class="primary-btn" href="#posts">阅读最新</a>
      <a class="secondary-btn" href="#subscribe">订阅邮件</a>
    </div>
  </div>
  <div class="hero-card">
    <div class="card-label">精选</div>
    {{if .FeaturedPosts}}
    <div class="featured-carousel" data-rotate="true">
      {{range $i, $post := .FeaturedPosts}}
      <div class="featured-slide {{if eq $i 0}}is-active{{end}}">
        {{if $post.CoverImage}}
        <div class="featured-thumb">
          <img src="{{$post.CoverImage}}" alt="{{$post.Title}}">
        </div>
        {{end}}
        <div class="featured-body">
          <h3>{{$post.Title}}</h3>
          <p>{{$post.Summary}}</p>
          <div class="card-meta">
            <span>{{formatDate $post.CreatedAt}}</span>
            {{if $post.Category}}<span class="badge">{{$post.Category}}</span>{{end}}
          </div>
          {{if $post.Tags}}
          <div class="tag-row">
            {{range $post.Tags}}<span class="tag">{{.}}</span>{{end}}
          </div>
          {{end}}
          <a class="text-link" href="{{$.SiteURL}}/posts/{{$post.Slug}}">阅读精选 -></a>
        </div>
      </div>
      {{end}}
    </div>
    {{else}}
    <h3>还没有精选文章</h3>
    <p>从后台新建一篇文章开始吧。</p>
    <a class="text-link" href="{{$.AdminURL}}/admin/posts/new">去创建 -></a>
    {{end}}
  </div>
  <div class="pagination">
    {{if .HasPrev}}
    <a class="pagination-link" href="{{$.SiteURL}}/?page={{.PrevPage}}#posts">← 上一页</a>
    {{else}}
    <span class="pagination-disabled">← 上一页</span>
    {{end}}
    <span class="pagination-info">第 {{.CurrentPage}} / {{.TotalPages}} 页</span>
    {{if .HasNext}}
    <a class="pagination-link" href="{{$.SiteURL}}/?page={{.NextPage}}#posts">下一页 →</a>
    {{else}}
    <span class="pagination-disabled">下一页 →</span>
    {{end}}
  </div>
</section>

<section id="posts" class="section">
  <div class="section-head">
    <h2>最新文章</h2>
    <p>每周更新一到两篇，关注产品、工程与写作。</p>
  </div>
  <div class="filter-bar">
    <div class="filter-group">
      <label for="filter-category">分类</label>
      <select id="filter-category">
        <option value="">全部</option>
        {{range .CategoryFilters}}
        <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
    <div class="filter-group">
      <label for="filter-tag">标签</label>
      <select id="filter-tag">
        <option value="">全部</option>
        {{range .TagFilters}}
        <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>
    </div>
  </div>
  <div class="post-grid fixed-grid">
    {{range .Posts}}
    <article class="post-card" data-category="{{.Category}}"
      data-tags="{{range $i, $t := .Tags}}{{if $i}},{{end}}{{lower $t}}{{end}}">
      <div class="post-thumb">
        {{if .CoverImage}}
        <img src="{{.CoverImage}}" alt="{{.Title}}">
        {{else}}
        <span>图片占位</span>
        {{end}}
      </div>
      <div class="post-meta">
        <span>{{formatDate .CreatedAt}}</span>
        {{if .Category}}<span class="badge">{{.Category}}</span>{{end}}
        {{if .Featured}}<span class="badge">精选</span>{{end}}
      </div>
      {{if .Tags}}
      <div class="tag-row">
        {{range .Tags}}<span class="tag">{{.}}</span>{{end}}
      </div>
      {{end}}
      <h3>{{.Title}}</h3>
      <p>{{.Summary}}</p>
      <a class="text-link" href="{{$.SiteURL}}/posts/{{.Slug}}">继续阅读 -></a>
    </article>
    {{end}}
  </div>
  <div class="pagination">
    {{if .HasPrev}}
    <a class="pagination-link" href="{{$.SiteURL}}/?page={{.PrevPage}}#posts">← 上一页</a>
    {{else}}
    <span class="pagination-disabled">← 上一页</span>
    {{end}}
    <span class="pagination-info">第 {{.CurrentPage}} / {{.TotalPages}} 页</span>
    {{if .HasNext}}
    <a class="pagination-link" href="{{$.SiteURL}}/?page={{.NextPage}}#posts">下一页 →</a>
    {{else}}
    <span class="pagination-disabled">下一页 →</span>
    {{end}}
  </div>
</section>

<section id="about" class="section about">
  <div>
    <h2>关于我</h2>
    <p>专注于把想法落成可持续的产品。写作是我的思考方式，也是持续输出的承诺。</p>
    <div class="about-tags">
      <span>产品策略</span>
      <span>Go 与架构</span>
      <span>写作系统</span>
      <span>个人知识管理</span>
    </div>
  </div>
  <div class="about-card">
    <h3>当前在做</h3>
    <ul>
      {{range .CurrentFocus}}
      <li>{{.}}</li>
      {{end}}
    </ul>
  </div>
</section>

<section id="subscribe" class="section subscribe">
  <div>
    <h2>订阅通讯</h2>
    <p>{{.Newsletter}}</p>
  </div>
  <form class="subscribe-form">
    <input type="email" placeholder="your@email.com" aria-label="Email" />
    <button class="primary-btn" type="button">加入订阅</button>
  </form>
</section>
<script>
  (function () {
    var root = document.querySelector(".featured-carousel");
    if (!root) return;
    var slides = root.querySelectorAll(".featured-slide");
    if (slides.length <= 1) return;
    var index = 0;
    setInterval(function () {
      slides[index].classList.remove("is-active");
      index = (index + 1) % slides.length;
      slides[index].classList.add("is-active");
    }, 3000);
  })();
  (function () {
    var categorySelect = document.getElementById("filter-category");
    var tagSelect = document.getElementById("filter-tag");
    var cards = document.querySelectorAll(".post-card");
    if (!categorySelect || !tagSelect || cards.length === 0) return;
    function applyFilter() {
      var category = categorySelect.value;
      var tag = tagSelect.value.toLowerCase();
      cards.forEach(function (card) {
        var cardCategory = card.getAttribute("data-category") || "";
        var cardTags = (card.getAttribute("data-tags") || "").split(",");
        var matchCategory = category === "" || cardCategory === category;
        var matchTag = tag === "" || cardTags.indexOf(tag) >= 0;
        card.style.display = matchCategory && matchTag ? "flex" : "none";
      });
    }
    categorySelect.addEventListener("change", applyFilter);
    tagSelect.addEventListener("change", applyFilter);
  })();
</script>
{{end}}